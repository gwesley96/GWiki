<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug: Library Bisection</title>
    <link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css">
    <script src="https://tikzjax.com/v1/tikzjax.js"></script>
    <style>
        .test-case { border: 1px solid #ccc; margin: 20px; padding: 10px; }
        .label { font-weight: bold; }
    </style>
</head>
<body>
    <h1>Library Bisection</h1>
    <p>We know "cd + patterns" works. Adding others to find the breaker.</p>

    <div class="test-case">
        <div class="label">1. CD + Patterns + Decorations (Markings & PathMorphing)</div>
        <script type="text/tikz">
            \usetikzlibrary{cd, patterns, decorations.markings, decorations.pathmorphing}
            % Minimal Preamble styles
            \pgfdeclarepatternformonly{primeddots}{\pgfqpoint{-1pt}{-1pt}}{\pgfqpoint{5pt}{5pt}}{\pgfqpoint{4pt}{4pt}}%
            { \pgfpathcircle{\pgfqpoint{0pt}{0pt}}{.5pt} \pgfusepath{fill} }
            \tikzset{ primedregion/.style={fill=#1, postaction={pattern=primeddots}} }
            
            \begin{tikzpicture}
                \fill[primedregion=blue!20] (0,0) rectangle (1,1);
                \begin{tikzcd} A \arrow[r] & B \end{tikzcd}
            \end{tikzpicture}
        </script>
    </div>

    <div class="test-case">
        <div class="label">2. CD + Patterns + Shapes & Arrows</div>
        <script type="text/tikz">
            \usetikzlibrary{cd, patterns, shapes.geometric, arrows.meta}
            % Minimal Preamble styles
            \pgfdeclarepatternformonly{primeddots}{\pgfqpoint{-1pt}{-1pt}}{\pgfqpoint{5pt}{5pt}}{\pgfqpoint{4pt}{4pt}}%
            { \pgfpathcircle{\pgfqpoint{0pt}{0pt}}{.5pt} \pgfusepath{fill} }
            \tikzset{ primedregion/.style={fill=#1, postaction={pattern=primeddots}} }
            
            \begin{tikzpicture}
                \fill[primedregion=blue!20] (0,0) rectangle (1,1);
                \begin{tikzcd} A \arrow[r] & B \end{tikzcd}
            \end{tikzpicture}
        </script>
    </div>

    <div class="test-case">
        <div class="label">3. CD + Patterns + Calc & Positioning</div>
        <script type="text/tikz">
            \usetikzlibrary{cd, patterns, calc, positioning}
            % Minimal Preamble styles
            \pgfdeclarepatternformonly{primeddots}{\pgfqpoint{-1pt}{-1pt}}{\pgfqpoint{5pt}{5pt}}{\pgfqpoint{4pt}{4pt}}%
            { \pgfpathcircle{\pgfqpoint{0pt}{0pt}}{.5pt} \pgfusepath{fill} }
            \tikzset{ primedregion/.style={fill=#1, postaction={pattern=primeddots}} }
            
            \begin{tikzpicture}
                \fill[primedregion=blue!20] (0,0) rectangle (1,1);
                \begin{tikzcd} A \arrow[r] & B \end{tikzcd}
            \end{tikzpicture}
        </script>
    </div>
</body>
</html>
